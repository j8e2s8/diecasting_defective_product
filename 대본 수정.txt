안녕하세요 yoyoyoyoyo 조에서 발표를 맡게된 장일준입니다.
금형 양산 공정을 어떻게 개선할지 데이터 분석한 것을 발표하겠습니다.

이번 분석 프로젝트 데이터는 다이캐스팅 데이터였습니다. <- 저희 회사는 다이캐스팅으로 제품 생산 어쩌구 하는 회사~ 컨셉 소개 하는게 어때
저희는 하루하루 지날 때마다 불량률이 어떻게 변화하는지 알아봤습니다.
2월 15일 이후로 불량률이 감소한 것을 발견 했습니다.  <- 시스템을 도입한 2월 15일 이후로~~ 이렇게가 나을 듯
PSI 플롯을 그려보니 이전과 이후의 '변수별 분포 그래프'가 바뀌었다는 것도 확인했습니다. <- 플롯 그릴거야?
그러면 2월 15일 이전의 데이터를 학습하지 않는것이 더욱 좋지 않을까요?

저희는 분석 주제를 이렇게 선정했습니다.
1. 기존에 데이터분석을 통해 불량 원인을 분석한 모델이 있었다.
2. 불량률을 낮추기 위해 2/15에 새로운 시스템을 도입했다.
3. 불량율이 낮아진 것을 확인했다.
4. 신규 생산 시 기존 모델의 솔루션을 신뢰할 수 있는가? 확인 필요하다.
즉, 불량과 정상품의 패턴을 파악함에 있어서 어떤 데이터를 선택하는 것이 좋냐...를 찾는 것입니다.


<- ---------------------------------------------------------
은서)
다이캐스팅 금형을 통해 제품 생산을 할 때 작성된 데이터입니다.
여러가지 변수들과 제품이 정상이었는지, 불량이었는지 기록되어 있습니다.

뒤에서 데이터 소개와 어떤 전처리를 했는지 알려드리겠습니다. 
저희는 크게, 데이터 자료형 변경, 결측치 해결, 불필요한 컬럼 제거, ~~ 했습니다.

가장 먼저 데이터 자료형을 보면 ~ 데이터가 이래서 이렇게 변환했습니다.

두번째로 결측치 해결로는 ~~ 데이터를 보면 이래서 제거 했습니다.

세번째로 불필요한 컬럼을 제거했는데, ~~ 데이터를 보면 이래서 제거 했습니다.


[데이터 소개, eda, 피처 엔지니어링 합쳐]

<----------------------------------------------------------


데이터 소개입니다.  

다이캐스팅 금형을 통해 제품 생산을 할 때 작성된 데이터입니다.
여러가지 변수들과 제품이 정상이었는지, 불량이었는지 기록되어 있습니다.


이 데이터를 통해 EDA를 진행했습니다.  <- 없애

먼저 타겟변수의 정상과 불량의 갯수입니다. 0이 정상, 1이 불량품입니다.
데이터가 불균형하기 때문에 이후 샘플링 기법을 고려하기로 했습니다.

각 변수의 확률 밀도 그래프를 봤습니다.

범주로 볼 수 있는 변수들을 범주화 하고 빈도 그래프를 그렸습니다.
Try Shot Signal 변수가 D값일 때, 불량률이 100%라는 것을 확인했습니다.

Try Shot 사탕의 개념을 짚고 넘어가겠습니다.
다이캐스팅 금형에는 쇳물이 들어갑니다. 쇳물은 유동성이 좋지 않습니다. 유동성은 흐르는 성질입니다. 특히 온도가 낮을 때는 유동성이 더 안 좋습니다.
이 상태에서 생산을 하면 완전한 제품이 나오지 않습니다.
양산시에 금형 온도가 높아야됩니다. 금형 온도를 높이기 위해서 양산 전 금형에 쇳물을 주입합니다.
정상 제품을 만들기 위해서가 아닌, 금형 온도를 높이기 위해 쇳물 주입하는 것을 사탕이라고 합니다.
즉, Try Shot Signal 변수가 D값일 때는 양산 중인 상태가 아닙니다.
저희의 목표는 양산 중 공정 개선을 하는 것이므로 이 데이터를 사용하지 않고 분석하기로 했습니다.

데이터 제거 후 계속해서 EDA를 진행했습니다.
~~~
~~~
~~~


모델을 만들기 전 피쳐엔지니어링을 진행했습니다. 파생변수를 넣고 뺌에 있어서, 각 모델에서 점수가 잘 나오면 넣었습니다.
그렇게 넣기로한 파생 변수는 4가지 입니다.
시간: 월일시분초 입니다.
양산일: 1월2일은 1, 1월 3일은 2... 이렇게 몇 번째 날인지 표시했습니다.
그룹: 하나의 변수에서 정상품이 주로 가지는 범위라면 0으로, 그 외에는 1로 표시.
IQR 외각 여부: 데이터 세트를 사분위수로 나누어 표시된 25% 점과 75%점 사이를 거리로 표현,
		   각 점에서 거리의 1.5배 벗어난 값을 극단값이라고 표시한것.

이제 모델을 만듭니다.
저희가 먼저 만들 모델은 기존에 만들어졌다고 가정했던 모델입니다. 2월 15일 이전 데이터로만 학습을 할 예정입니다.

분류 모델은 두가지를 사용하여 점수가 잘 나온 것으로 챔피언 모델을 선택하기로 했습니다.
평가는 G-mean 점수를 사용했습니다.
라이트GBM과 캣부스트입니다.

타겟변수가 불균형한 데이터이기 때문에 샘플링 기법을 사용합니다.
랜덤언더샘플링, 랜덤오버샘플링, SMOTE, 샘플링 기법은 아니지만 소수클래스에 가중치를 주는 옵션을 모델에서 사용했습니다.

각 모델을 만드는 샘플링 기법, 분류 모델에 대한 평가는, 3월 25일부터 3월 31일까지 생긴 데이터를 정상 불량 예측한 결과로 평가했습니다.

이렇게 샘플링, 분류 모델, 파생변수를 확정지어 기존 모델을 만들었습니다.

(혼동행렬 그림)

저희가 만들어야 할 모델은 3가지 입니다.
1. 2월 15일 이전 데이터를 활용하여 기존에 만들어졌다고 가정했던 모델. 
2. 시스템 도입 후 2월 15일부터 3월 24일 사이에 생긴 데이터로 만들어진 모델.
3. 전체 기간 데이터로 만들어진 모델.
앞서 작업했던 순서대로 나머지 모델도 만들었습니다.
이렇게 3가지 모델을 만들었습니다.

각각 모델을 비교해보겠습니다.
(혼돈행렬, G-mean)
분류를 가장 잘 하는 모델은 [전체 기간 데이터로 만들어진 모델]입니다.

이것이 의미하는 바는, "현재 데이터로는 전체 기간의 데이터를 사용하는 것이 좋다"입니다.
(분포가 달라졌지만 정상품과 불량품으로 나눠지는 점은 같다는 그림)
앞서 살펴본대로 시스템 도입 기준으로 분포가 달라졌습니다.
하지만 불량과 정상으로 나누는 기준은 변하지 않은거죠.
분포는 변했지만, 정상과 불량을 구분하는데 있어 시스템 도입 전과 후 데이터 모두 의미있는 것을 알 수 있습니다.
"더 많은 데이터를 학습한 모델이 성능도 좋다"라는 것입니다.

다음은 앞서 결정된 모델의 변수 중요도 입니다.
정상과 불량을 나누는데 ***변수가 가장 중요했다는 것을 확인했습니다.

다음은 변수 값 변화에 따른 불량률입니다.
***변수가 @@보다는 높게 유지해야 양산하기 좋습니다.

요약입니다.
